# AirTrace RU v0.3.0

Дата релиза: 2026-02-14

## Что вошло

### 1) Честные таймсерии и экспорт без симуляции
- В `web/web_app.py` удалена генерация псевдо-исторических данных через `random`.
- Таймсерии и экспорт теперь формируются только из реального почасового прогноза.
- Добавлены явные эндпоинты:
  - `GET /api/timeseries/{city_key}`
  - `GET /api/timeseries-custom`
- Legacy-эндпоинты `historical*` сохранены для обратной совместимости.

### 2) Улучшение UX веб-интерфейса
- В `web/templates/city.html` обновлены тексты и терминология: “прогноз/таймсерия” вместо “истории”.
- Улучшены состояния пустых/ошибочных ответов и сообщения пользователю.
- Экспорт в UI теперь проверяет HTTP-ответ сервера перед уведомлением об успехе.
- Добавлены более понятные CTA и статусные подписи по источнику/доступному горизонту.

### 3) Улучшение UX формы пользовательских координат
- В `web/templates/custom_city.html` добавлена мягкая client-side валидация перед submit.
- Добавлены уведомления об ошибках ввода вместо “немых” сбоев.

### 4) Исправление схемы health-check
- В `schemas.py` поле `HealthCheckResponse.services` расширено до `Dict[str, Any]`.
- Это устраняет ошибки валидации при вложенных статусах (`graceful_degradation`, `fallback_capabilities`).

### 5) Синхронизация документации с реальным состоянием проекта
- Обновлены `README.md` и `web/README.md`.
- Удалены невалидные/несуществующие инструкции деплоя.
- Уточнены ограничения и поведение экспорта/таймсерий.

### 6) Стабильность API в окружениях с прокси
- Исправлена недоступность `/weather/current` и `/weather/forecast` при `HTTP_PROXY/HTTPS_PROXY` в окружении.
- Для внутренних HTTP-клиентов включен режим `trust_env=False`, чтобы некорректные proxy-env не ломали запросы к внешним API и локальному backend.
- Изменения внесены в `services.py`, `connection_pool.py`, `web/web_app.py`.

## Совместимость
- API-контракты для основных маршрутов сохранены.
- Старые маршруты `historical*` продолжают работать как aliases.

## Примечание
- В средах с системным прокси может потребоваться настройка bypass для `localhost/127.0.0.1/LAN`.
